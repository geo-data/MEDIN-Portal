<%doc>
 Created by Homme Zwaagstra
 
 Copyright (c) 2010 GeoData Institute
 http://www.geodata.soton.ac.uk
 geodata@soton.ac.uk
 
 Unless explicitly acquired and licensed from Licensor under another
 license, the contents of this file are subject to the Reciprocal
 Public License ("RPL") Version 1.5, or subsequent versions as
 allowed by the RPL, and You may not copy or use this file in either
 source code or executable form, except in compliance with the terms
 and conditions of the RPL.
 
 All software distributed under the RPL is provided strictly on an
 "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR
 IMPLIED, AND LICENSOR HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT, OR
 NON-INFRINGEMENT. See the RPL for specific language governing rights
 and limitations under the RPL.
 
 You can obtain a full copy of the RPL from
 http://opensource.org/licenses/rpl1.5.txt or geodata@soton.ac.uk
</%doc>\
<%namespace import="search_criteria" file="search-common.html"/>
<%inherit file="base-ok.html"/>\
<%!
    from medin.filters import quote as q
%>

<%def name="header()">
    <link rel="alternate"
          type="application/vnd.google-earth.kml+xml"
          href="${resource_root}/kml"
          title="MEDIN - ${title | x}"/>
</%def>\

<%def name="left_menu()">\
  <div class="info">
    ${search_criteria()}
    <p>
    % if referrer_query_string:
<a href="${script_root}/full/catalogue${referrer_query_string | x}" title="Go back to your search results">Return to your results</a>\
    % else:
<a href="${script_root}/full/catalogue" title="View the catalogue contents">View the catalogue</a>\
    % endif
 or <a href="${script_root}/full${referrer_query_string | x}" title="Edit the current search criteria">Edit this search</a>.</p>
  </div>
  <div class="info">
    <h3>Download</h3>
    <p>The metadata is available for downloading in the following formats:</p>
    <ul>
      <li><a href="${resource_root}/csv">MEDIN format</a> (<abbr title="Comma Separated Values">CSV</abbr>)</li>
      <li><a href="${resource_root}/MEDIN_2.3">MEDIN format</a> (XML version 2.3.1)</li>
      <li><a href="${resource_root}/DC">Dublin Core format</a> (XML)</li>
      <li><a href="${resource_root}/DIF_9.4">GCMD DIF format</a> (XML version 9.4)</li>
    </ul>
    <p>This metadata complies with <a href="http://www.inspire-geoportal.eu" title="Infrastructure for Spatial Information in the European Community">INSPIRE</a> and <a href="http://www.gigateway.org.uk/metadata/standards.html" title="Geo-spatial Metadata Interoperability Initiative">GEMINI 2</a> standards.</p>
  </div>
</%def>\

<%def name="format_date(date)">\
% if date.year >= 1900:
  ${date.strftime('%A %d %B %Y')}\
% else:
  ${date.date().isoformat()}\
% endif
</%def>\

<%def name="format_search_date(date)">\
${date.date().isoformat()}\
</%def>\

<%def name="output_element(element, number)">
  % if isinstance(element, Exception):
    <div class="error">${element.message}. (<a href="javascript:toggle('error-${number}', 'details', 'hide details')" id="error-${number}-link" title="Show or hide the error details">details</a>)</div>
    <div class="error" id="error-${number}" style="display:none">${element.detail}</div>
  % else:
    ${caller.body()}
  % endif
</%def>\

<%def name="format_contacts(contacts, quote=False)">
  % if quote:
  <blockquote>
  % endif
        % for i, contact in enumerate(contacts):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
    <strong>
    % if contact.organisation:
      ${contact.organisation | x}
    % elif contact.name:
      ${contact.name | x}
    % elif contact.position:
      ${contact.position | x}
    % else:
      Unnamed contact
    % endif
    </strong><br/>
    % if contact.name and contact.organisation:
    Individual name: ${contact.name | x}<br/>
        % endif
    % if contact.position and (contact.name or contact.organisation):
    Position: ${contact.position | x}<br/>
        % endif
    % if contact.address:
    Address: <a href="http://maps.google.co.uk/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q=${contact.address | u}" title="View the location">${contact.address | x}</a><br/>
        % endif
    % if contact.email:
    Email: <a href="mailto:${contact.email}">${contact.email}</a><br/>
        % endif
    % if contact.tel:
    Telephone: ${contact.tel | x}<br/>
        % endif
    % if contact.fax:
    Facsimile: ${contact.fax | x}<br/>
        % endif
    % if contact.roles:
    Roles:
    <ul>
      % for role in contact.roles:
      <li>${role}</li>
      % endfor
        </ul>
        % endif
    % if contact.contacts:
    ${format_contacts(contact.contacts, True)}
    % endif
    </div>
        % endfor
    % if quote:
  </blockquote>
    % endif
</%def>\

% if metadata.bbox:
<!-- Element 12 -->
<div class="extent right">
  <div class="info">
  <h3>Geographic Extent</h3>
  <img class="extent" src="${resource_root}/extent.png" alt="Geographic bounding box" title="Geographic extent of the data"/>
  <p class="no-bottom">
  The metadata covers the area West - East from ${metadata.bbox[0]}&deg; to
  ${metadata.bbox[2]}&deg; and North - South from ${metadata.bbox[3]}&deg; to
  ${metadata.bbox[1]}&deg;.

  <a
  href="${script_root}/full/catalogue?bbox=${metadata.bbox[0]},${metadata.bbox[1]},${metadata.bbox[2]},${metadata.bbox[3]}"
  title="Area search for metadata">Search</a> for all metadata within
  this area.
  </p>
  </div>
  <p class="lower-link right">
    <a href="${resource_root}/kml" title="View the extent as a KML file"><img alt="KML" width="16" height="16" src="/images/kml.png" class="image_no_border"/> KML</a>
  </p>
</div>
% endif\

<h2>Overview</h2>

<!-- Element 3 -->
<p><strong>Abstract:</strong> ${metadata.abstract}</p>

% if metadata.keywords:
<!-- Element 11 -->
<p class="no-bottom"><strong>Keywords:</strong></p>
  % for title, defns in metadata.keywords.items():
  <div><strong>${title | x}</strong></div>
  <div class="subitem">
    % for i, (keyword, defn) in enumerate(defns.items()):
      % if i:
      <div class="sibling">
      % else:
      <div>
      % endif
      % if 'error' in defn:
        <span class="error">${defn['error']}</span>
      % else:
        <% if defn:
             if defn['short']: keyword = defn['short']
             else: keyword = defn['long']
        %>
        <a href="${script_root}/full/catalogue?q=p:${keyword | q,u,x}"
           title="Search for all metadata having the parameter '${keyword | x}'">${keyword | x}</a>
        % if defn:
          % if defn['short'] and defn['long'] != defn['short']:
          - ${defn['long'] | x}
          % endif
        <br/>Definition: ${defn['defn'] | x}
        % endif
      % endif
      </div>
    % endfor
  </div>
  % endfor
% endif\

<h2>Details</h2>
<p class="no-bottom">Details for the metadata are as follows:</p>

<table summary="Metadata details" class="tabulate">

  % if metadata.alt_titles:
  <!-- Element 2 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Alternative resource title</strong> (<a href="javascript:toggle('element-2', 'info', 'hide info')" id="element-2-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-2" class="cell element-info">
        <p>The alternative title is used to add the names by which the
        resource (e.g. dataset) may be known and may include short
        name, other name, acronym or alternative language title.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.alt_titles}" number="${2}">
        % for i, detail in enumerate(metadata.alt_titles):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
        ${detail}</div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.unique_id:
  <!-- Element 6 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Unique resource identifier</strong> (<a href="javascript:toggle('element-6', 'info', 'hide info')" id="element-6-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-6" class="cell element-info">
        <p>A Unique Resource Identifier allows a dataset to be identified
        by a code. This code is generally assigned by the data owner
        and commonly consists of the organisation which manages the
        dataset and a number or code which is used to uniquely
        identify it within the databases of the organisation. If this
        code is unique then it is possible for an organisation to
        identify a dataset that a 3rd party may be referring to and
        also to quickly identify where dataset records may be
        duplicated in a portal.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.alt_titles}" number="${6}">
      ${metadata.unique_id}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.online_resource:
  <!-- Element 5 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Resource locator</strong> (<a href="javascript:toggle('element-5', 'info', 'hide info')" id="element-5-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-5" class="cell element-info">
        <p>The online location of the resource.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.online_resource}" number="${5}">
        % for i, resource in enumerate(metadata.online_resource):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
          <a href="${resource['link']}" title="External link ${i+1}">\
            % if resource['name']:
${resource['name']}
            % else:
External link ${i+1}\
            % endif
</a>
          % if resource['description']:
          - ${resource['description']}
          % endif
        </div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.access_limits:
  <!-- Element 20 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Limitations on public access</strong> (<a href="javascript:toggle('element-20', 'info', 'hide info')" id="element-20-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-20" class="cell element-info">
        <p>This element describes any restrictions imposed on the
        resource for security and other reasons using the controlled
        ISO vocabulary RestrictionCode. If there are no limitations on
        public access, this must be indicated. All terms are can be
        found in the <a
        href="http://www.oceannet.org/marine_data_standards/medin_disc_stnd.html">MEDIN
        discovery standard</a>.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.access_limits}" number="${20}">
        % for i, defn in enumerate(metadata.access_limits):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
        % if 'error' in defn:
          <span class="error">${defn['error']}</span>
        % elif 'other' in defn:
          Other constraints: ${defn['other'] | x}
        % else:
          <a href="${script_root}/full/catalogue?q=al:${defn['short'] | q,u,x}"
             title="Search for all metadata having the access limit '${defn['short'] | x}'">${defn['short'] | x}</a>
          <br/>Definition: ${defn['defn'] | x}
        % endif
        </div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.access_conditions:
  <!-- Element 21 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Conditions for access and use constraints</strong> (<a href="javascript:toggle('element-21', 'info', 'hide info')" id="element-21-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-21" class="cell element-info">
        <p>This element describes any restrictions and legal
        restraints on using the data.  Any known constraints such as
        fees should be identified.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.access_conditions}" number="${21}">
        % for i, detail in enumerate(metadata.access_conditions):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
        ${detail}</div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.resource_type:
  <!-- Element 4 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Resource type</strong> (<a href="javascript:toggle('element-4', 'info', 'hide info')" id="element-4-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-4" class="cell element-info">
        <p>Identify the type of resource e.g. a dataset using the
        controlled vocabulary, MD_ScopeCode from ISO 19115.  In order
        to comply with INSPIRE the resource type must be a dataset, a
        series (collection of datasets with a common specification) or
        a service. All terms can be found in the <a
        href="http://www.oceannet.org/marine_data_standards/medin_disc_stnd.html">MEDIN
        discovery standard</a></p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.resource_type}" number="${4}">
        <% defn = metadata.resource_type %>
        <div>
        % if 'error' in defn:
          <span class="error">${defn['error']}</span>
        % else:
          <a href="${script_root}/full/catalogue?q=rt:${defn['short'] | q,u,x}"
             title="Search for all metadata having the resource type '${defn['short'] | x}'">${defn['short'] | x}</a>
          <br/>Definition: ${defn['defn'] | x}
        % endif
        </div>
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.data_format:
  <!-- Element 23 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Data format</strong> (<a href="javascript:toggle('element-23', 'info', 'hide info')" id="element-23-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-23" class="cell element-info">
        <p>Indicate the formats in which digital data can be provided
        for transfer. <a
        href="http://vocab.ndg.nerc.ac.uk/clients/getList?recordKeys=http%3A%2F%2Fvocab.ndg.nerc.ac.uk%2Flist%2FM010%2Fcurrent&amp;earliestRecord=&amp;submit=submit">MEDIN
        controlled vocabulary M010</a> lists the valid terms.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.data_format}" number="${23}">
        % for i, (keyword, defn) in enumerate(metadata.data_format.items()):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
        % if 'error' in defn:
          <span class="error">${defn['error']}</span>
        % else:
          % if defn:
          <a href="${script_root}/full/catalogue?q=f:${defn['long'] | q,u,x}"
             title="Search for all metadata having the data format '${defn['long'] | x}'">${defn['long'] | x}</a>
          <br/>Definition: ${defn['defn'] | x}
          % else:
          ${keyword | x}
          % endif
        % endif
        </div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  <!-- Element 7 to be implemented -->

  % if metadata.service_type:
  <!-- Element 10 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Spatial data service type</strong> (<a href="javascript:toggle('element-10', 'info', 'hide info')" id="element-10-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-10" class="cell element-info">
        <p>An element required by INSPIRE for metadata about data
        services e.g. web services.  If a service is being described
        it must be assigned a service type from the INSPIRE Service
        type code list.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.service_type}" number="${10}">
        % for i, detail in enumerate(metadata.service_type):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
        ${detail}</div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.temporal_reference:
  <!-- Element 16 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Temporal reference</strong> (<a href="javascript:toggle('element-16', 'info', 'hide info')" id="element-16-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-16" class="cell element-info">
        <p>It is recommended that all known temporal references of the
        resource are included. The temporal extent of the resource
        (e.g. the time period over which data were collected) and the
        date of publication (i.e. the date at which it was made
        publicly available) are mandatory.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.temporal_reference}" number="${16}">
        %if 'range' in metadata.temporal_reference:
        <div>
          The data spans the period from <a href="${script_root}/full/catalogue?sd=${format_search_date(metadata.temporal_reference['range'][0])}&amp;ed=${format_search_date(metadata.temporal_reference['range'][1])}" title="Search for all records between these dates">${format_date(metadata.temporal_reference['range'][0])} to ${format_date(metadata.temporal_reference['range'][1])}</a> inclusive.
        </div>
        %endif
        %if 'single' in metadata.temporal_reference:
          % for i, (code, date) in enumerate(metadata.temporal_reference['single']):
          % if i or 'range' in metadata.temporal_reference:
        <div class="sibling">
          % else:
        <div>
          % endif
        ${code.capitalize()} date was ${format_date(date)} [<a href="${script_root}/full/catalogue?ed=${format_search_date(date)}" title="List all previous records">Previous records</a>] [<a href="${script_root}/full/catalogue?sd=${format_search_date(date)}" title="List all subsequent records">Subsequent records</a>]
        </div>
          % endfor
        %endif
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.extents:
  <!-- Element 13 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Extent</strong> (<a href="javascript:toggle('element-13', 'info', 'hide info')" id="element-13-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-13" class="cell element-info">
        <p>Keywords selected from controlled vocabularies to describe
        the spatial extent of the resource.  MEDIN strongly recommends
        the use of the <a
        href="http://www.bodc.ac.uk/data/codes_and_formats/seavox/">SeaVox
        Sea Areas</a> which is a managed vocabulary and has a
        worldwide distribution. Other vocabularies available including
        <a href="http://www.ices.dk/">ICES areas and rectangles</a> or
        Charting Progress 2 regions may be used.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.extents}" number="${13}">
        % for i, details in enumerate(metadata.extents):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
          ${details['title']}: 
          % if details['id']:
          <a href="${script_root}/full/catalogue?a=${details['id'] | u}"
             title="Search for all metadata in the area '${details['name'] | x}'">${details['name'] | x}</a>
          % else:
          ${details['name'] | x}
          % endif
        </div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.vertical_extent:
  <!-- Element 14 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Vertical extent information</strong> (<a href="javascript:toggle('element-14', 'info', 'hide info')" id="element-14-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-14" class="cell element-info">
        <p>This element should only be filled in if the Coordinate
        Reference System is registered in the <a
        href="http://epsg-registry.org/">‘European Petroleum Survey
        Group (EPSG) database</a>.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.vertical_extent}" number="${14}">
        <% count = 0 %>
        % if 'min-value' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          Minimum value: ${metadata.vertical_extent['min-value']}
          <% count+=1 %>
        % endif
        </div>
        % if 'max-value' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          Maximum value: ${metadata.vertical_extent['max-value']}
          <% count+=1 %>
        % endif
        </div>
        % if 'crs' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          <abbr title="Coordinate Reference System">CRS</abbr>: ${metadata.vertical_extent['crs']}
          <% count+=1 %>
        % endif
        </div>
        % if 'crs-id' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          <abbr title="Coordinate Reference System">CRS</abbr> identifier ${metadata.vertical_extent['crs-id'][0]}: ${metadata.vertical_extent['crs-id'][1]}
          <% count+=1 %>
        % endif
        </div>
        % if 'crs-name' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          <abbr title="Coordinate Reference System">CRS</abbr> name: ${metadata.vertical_extent['crs-name']}
          <% count+=1 %>
        % endif
        </div>
        % if 'crs-scope' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          <abbr title="Coordinate Reference System">CRS</abbr> scope: ${metadata.vertical_extent['crs-scope']}
          <% count+=1 %>
        % endif
        </div>
        % if 'cs-id' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          <abbr title="Coordinate System">CS</abbr> identifier ${metadata.vertical_extent['cs-id'][0]}: ${metadata.vertical_extent['cs-id'][1]}
          <% count+=1 %>
        % endif
        </div>
        % if 'cs-name' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          <abbr title="Coordinate System">CS</abbr> name ${metadata.vertical_extent['cs-name']}
          <% count+=1 %>
        % endif
        % if 'csaxis-id' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          <abbr title="Coordinate System">CS</abbr> axis identifier ${metadata.vertical_extent['csaxis-id'][0]}: ${metadata.vertical_extent['csaxis-id'][1]}
          <% count+=1 %>
        % endif
        </div>
        % if 'csaxis-info' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          <abbr title="Coordinate System">CS</abbr> axis is ${metadata.vertical_extent['csaxis-info'][0]} (${metadata.vertical_extent['csaxis-info'][1]})
          <% count+=1 %>
        % endif
        </div>
        % if 'datum-id' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          Datum identifier ${metadata.vertical_extent['datum-id'][0]}: ${metadata.vertical_extent['datum-id'][1]}
          <% count+=1 %>
        % endif
        </div>
        % if 'datum-name' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          Datum name: ${metadata.vertical_extent['datum-name']}
          <% count+=1 %>
        % endif
        </div>
        % if 'datum-scope' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          Datum scope: ${metadata.vertical_extent['datum-scope']}
          <% count+=1 %>
        % endif
        </div>
        % if 'datum-info' in metadata.vertical_extent:
        % if count:
        <div class="sibling">
        % else:
        <div>
        % endif
          Datum details: ${metadata.vertical_extent['datum-info']}
          <% count+=1 %>
        % endif
        </div>
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.reference_system:
  <!-- Element 15 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Spatial reference system</strong> (<a href="javascript:toggle('element-15', 'info', 'hide info')" id="element-15-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-15" class="cell element-info">
        <p>Describes the system of spatial referencing (typically a
        coordinate reference system) used in the resource.  This
        should be derived from the <a
        href="http://www.epsg.org/Geodetic.html">EPSG register of
        geodetic parameters</a>. To find a code click on the OGP
        Online Registry and if you know the title (eg WGS84) then type
        this in the ‘Name’ field and click search. The name, code and
        further information is displayed. If you are looking for a
        specific type of reference system such as ‘vertical’ then
        click in the ‘Type’ box, hover over coordinate reference
        system and click on vertical and then click the search button
        and all recorded vertical reference systems are shown. If you
        want to search for a reference system in a particular part of
        the world (e.g. Northern Ireland Grid) the you may do so by
        submitting a term to the ‘Area’ box or fill out the lat and
        longs then click search. The website also provides a database
        of the reference systems and web services to access the
        information.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.reference_system}" number="${15}">
        <div>
          Identifier: ${metadata.reference_system['identifier']}
        </div>
        <div class="sibling">
          Source: <a href="${metadata.reference_system['url']}">${metadata.reference_system['source']}</a>
        </div>
        % if metadata.reference_system['name']:
        <div class="sibling">
          Name: ${metadata.reference_system['name']}
        </div>
        % endif
        % if metadata.reference_system['scope']:
        <div class="sibling">
          Scope: ${metadata.reference_system['scope']}
        </div>
        % endif
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.spatial_resolution:
  <!-- Element 18 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Spatial resolution</strong> (<a href="javascript:toggle('element-18', 'info', 'hide info')" id="element-18-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-18" class="cell element-info">
        <p>Provides an indication of the spatial resolution of the
        data. The element has largely been derived for the mapping
        community and is currently poorly defined however MEDIN
        recommends that you provide the average distance
        (i.e. resolution) between sampling locations in meters. For
        example, if a dataset was composed of a grid of stations which
        have an average distance between stations of 2 km then 2000
        meters should be recorded. In the case of a multibeam survey
        it should be the average distance between each sounding or
        ‘ping’ on the sea bed. For transect data such as an intertidal
        beach survey or a single beam echo sounder survey the
        resolution should be taken as the distance between the
        transect lines.</p>
        <p>For single samples and observational data MEDIN recommends
        using ‘not applicable’.</p>
        <p>MEDIN is in discussions with GEMINI and ISO to allow the
        use of scale for this element (e.g. pressure) and also to
        allow the use of ‘unknown’. GEMINI accepts that in many cases
        only approximate values can be given.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.spatial_resolution}" number="${18}">
        % for i, detail in enumerate(metadata.spatial_resolution):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
        % if 'distance' in detail:
    Distance: ${detail['distance']} meters
    % elif 'scale' in detail:
    Scale 1:${detail['scale']}
    %endif
    </div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.topic_category:
  <!-- Element 9 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Topic category</strong> (<a href="javascript:toggle('element-9', 'info', 'hide info')" id="element-9-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-9" class="cell element-info">
        <p>This element is mandatory for INSPIRE and must be
        included. This indicates the main theme(s) of the data
        resource.  It is required for INSPIRE compliance.  The
        relevant topic category should be selected from the <a
        href="http://vocab.ndg.nerc.ac.uk/clients/getList?recordKeys=http%3A%2F%2Fvocab.ndg.nerc.ac.uk%2Flist%2FP051%2Fcurrent&amp;earliestRecord=&amp;submit=submit">ISO
        19115/TC 211 Topic Category list</a>. Within MEDIN the
        parameter group keywords from the <a
        href="http://vocab.ndg.nerc.ac.uk/clients/getList?recordKeys=http%3A%2F%2Fvocab.ndg.nerc.ac.uk%2Flist%2FP021%2Fcurrent&amp;earliestRecord=&amp;submit=submit">BODC
        Parameter Discovery Vocabulary (P021) list</a> are mapped to
        the ISO Topic Categories so it is possible to generate the
        topic categories automatically once the keywords from BODC
        Parameter Discovery Vocabulary (P021) have been selected.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.topic_category}" number="${9}">
        % for i, (keyword, defn) in enumerate(metadata.topic_category.items()):
        % if i:
        <div class="sibling">
        % else:
        <div>
        % endif
        % if 'error' in defn:
          <span class="error">${defn['error']}</span>
        % else:
          % if defn:
          <a href="${script_root}/full/catalogue?q=tc:${defn['short'] | q,u,x}"
             title="Search for all metadata having the topic category '${defn['short'] | x}'">${defn['short'] | x}</a>
            % if defn['long'] != defn['short']:
            - ${defn['long'] | x}
            % endif
          <br/>Definition: ${defn['defn'] | x}
          % else:
          ${keyword | x}
          % endif
        % endif
        </div>
        % endfor
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\
  
  % if metadata.lineage:
  <!-- Element 17 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Lineage</strong> (<a href="javascript:toggle('element-17', 'info', 'hide info')" id="element-17-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-17" class="cell element-info">
        <p>Lineage includes the background information, history of the
        sources of data used and can include data quality statements.
        The lineage element can include information about: source
        material; data collection methods used; data processing
        methods used; quality control processes.  This should include
        any data collection standards used.  Additional information
        source to record relevant references to the data e.g. reports,
        articles, website.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.lineage}" number="${17}">
      ${metadata.lineage}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.additional_info:
  <!-- Element 19 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Additional information</strong> (<a href="javascript:toggle('element-19', 'info', 'hide info')" id="element-19-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-19" class="cell element-info">
        <p>Any references to external information that are considered
        useful, e.g. project website, report, journal article may be
        recorded.  It should not be used to record additional
        information about the resource.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.additional_info}" number="${19}">
      ${metadata.additional_info}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.responsible_party:
  <!-- Element 22 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Responsible party</strong> (<a href="javascript:toggle('element-22', 'info', 'hide info')" id="element-22-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-22" class="cell element-info">
        <p>Provides a description of an organisation or person who has
        a role for the dataset or resource. 'Originator' (a mandatory
        field) is the person or organisation who created the
        resource. 'Custodian' (a mandatory field) is the person or
        organisation that accepts responsibility for the data and
        ensures appropriate care and maintenance.</p>
        <p>If the data has been lodged with a MEDIN approved Data
        Archive Centre then the DAC should be specified as the
        Custodian. 'Distributor' (a conditional field) is the person
        or organisation that distributes the
        resource. 'pointOfContact' is the party who can be contacted
        for acquiring knowledge about or acquisition of the
        resource. There are further designations listed at 'Annex
        H. ISO Responsible party codelist' in 'Guidance notes for the
        production of discovery metadata for the Marine Environmental
        Data and Information Network (MEDIN)'.</p>
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.responsible_party}" number="${22}">
    ${format_contacts(metadata.responsible_party)}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  <!-- Element 25 to be implemented -->

  % if metadata.resource_language:
  <!-- Element 8 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Resource language</strong> (<a href="javascript:toggle('element-8', 'info', 'hide info')" id="element-8-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-8" class="cell element-info">
        Describes the language(s) of any textual information contained within the resource.
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.resource_language}" number="${25}">
        ${metadata.resource_language}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\
  
  % if metadata.update_frequency:
  <!-- Element 24 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Frequency of update</strong> (<a href="javascript:toggle('element-24', 'info', 'hide info')" id="element-24-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-24" class="cell element-info">
        This describes the frequency that the resource (data set) is
        modified or updated and should be included if known.  For
        example if the data set is from a monitoring programme which
        samples once per year then the frequency is annually.
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.update_frequency}" number="${24}">
        ${metadata.update_frequency}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.date:
  <!-- Element 26 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Date of update of metadata</strong> (<a href="javascript:toggle('element-26', 'info', 'hide info')" id="element-26-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-26" class="cell element-info">
        This describes the last date the metadata was updated on. If
        the metadata has not been updated it should give the date on
        which it was created.
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.date}" number="${26}">
        ${format_date(metadata.date)}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.name:
  <!-- Element 27 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Metadata standard name</strong> (<a href="javascript:toggle('element-27', 'info', 'hide info')" id="element-27-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-27" class="cell element-info">
        Identify the metadata standard used to create the metadata.
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.name}" number="${27}">
        ${metadata.name}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.version:
  <!-- Element 28 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Metadata standard version</strong> (<a href="javascript:toggle('element-28', 'info', 'hide info')" id="element-28-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-28" class="cell element-info">
        Identify the version of the metadata standard used to create the metadata.
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.version}" number="${28}">
        ${metadata.version}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

  % if metadata.language:
  <!-- Element 29 -->
  <tr>
    <td class="heading">
      <div class="cell">
        <strong>Metadata language</strong> (<a href="javascript:toggle('element-29', 'info', 'hide info')" id="element-29-link" title="Show or hide the element information">info</a>)
      </div>
    </td>
    <td class="content">
      <div id="element-29" class="cell element-info">
        Describes the language(s) elements of the metadata.
      </div>
      <div class="cell">
        <%self:output_element element="${metadata.version}" number="${28}">
        ${metadata.language}
        </%self:output_element>
      </div>
    </td>
  </tr>
  % endif\

</table>
